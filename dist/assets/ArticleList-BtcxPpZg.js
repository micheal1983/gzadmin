import{_ as y,i as g,c as n,a as t,p as u,F as k,k as w,m as b,u as A,j as h,o as r,t as l,y as C}from"./index-J5bTViEi.js";import{a as p}from"./article-CU4BPepM.js";import"./request-CgiPNpti.js";const D={class:"article-list"},L={class:"page-header"},S={key:0,class:"loading-state"},x={key:1,class:"data-table"},N=["onClick"],B=["onClick"],I={key:0},$={__name:"ArticleList",setup(j){const c=A(),o=h([]),i=h(!0),_=s=>{if(!s)return{author:"Admin",content:"",cover:""};try{let e=typeof s=="string"?JSON.parse(s):s;return typeof e=="string"&&(e=JSON.parse(e)),{author:e.author||"Admin",content:e.content||"",cover:e.cover||""}}catch{return{author:"Admin",content:String(s),cover:""}}},f=s=>s?new Date(s*1e3).toLocaleDateString():"-",d=async()=>{i.value=!0;try{const s=await p.getList();s.code===200?o.value=s.data:alert(s.msg||"获取列表失败")}catch(s){console.error("获取文章列表出错:",s)}finally{i.value=!1}},v=async s=>{if(confirm("确定要删除这篇文章吗？"))try{const e=await p.del(s);e.code===200?(alert("删除成功"),o.value=o.value.filter(a=>a.id!==s),await d(),window.location.reload()):alert("后端提示："+e.msg)}catch{alert("删除操作异常")}};return g(()=>{d()}),(s,e)=>(r(),n("div",D,[t("div",L,[e[1]||(e[1]=t("h2",null,"文章管理 (全部状态)",-1)),t("button",{class:"btn-add",onClick:e[0]||(e[0]=a=>u(c).push({name:"ArticleAdd"}))},"新增文章")]),i.value?(r(),n("div",S,"数据加载中...")):(r(),n("table",x,[e[3]||(e[3]=t("thead",null,[t("tr",null,[t("th",{width:"80"},"ID"),t("th",null,"标题"),t("th",{width:"100"},"状态"),t("th",{width:"120"},"作者"),t("th",{width:"150"},"发布时间"),t("th",{width:"180"},"操作")])],-1)),t("tbody",null,[(r(!0),n(k,null,w(o.value,a=>(r(),n("tr",{key:a.id},[t("td",null,l(a.id),1),t("td",null,l(a.name),1),t("td",null,[t("span",{class:C(["status-tag",a.status==1?"status-show":"status-hide"])},l(a.status==1?"显示":"隐藏"),3)]),t("td",null,l(_(a.info).author),1),t("td",null,l(f(a.create_time)),1),t("td",null,[t("button",{class:"btn-edit",onClick:m=>u(c).push({name:"ArticleEdit",params:{id:a.id}})}," 编辑 ",8,N),t("button",{class:"btn-delete",onClick:m=>v(a.id)}," 删除 ",8,B)])]))),128)),o.value.length===0?(r(),n("tr",I,[...e[2]||(e[2]=[t("td",{colspan:"6",class:"empty-text"},"暂无数据",-1)])])):b("",!0)])]))]))}},O=y($,[["__scopeId","data-v-84b7a127"]]);export{O as default};
